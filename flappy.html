<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flappy Bird</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  background: #020617;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: Arial, sans-serif;
  color: white;
}

.container {
  text-align: center;
}

canvas {
  background: linear-gradient(#60a5fa, #93c5fd);
  border-radius: 12px;
}

button {
  margin: 8px;
  padding: 8px 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: #38bdf8;
  font-size: 16px;
}

.home-btn {
  background: #64748b;
  color: white;
}
</style>
</head>

<body>

<div class="container">
  <h2>üê¶ Flappy Bird</h2>

  <canvas id="game" width="320" height="420"></canvas><br>

  <button onclick="startGame()">‚ñ∂ Start</button>
  <button class="home-btn" onclick="location.href='index.html'">‚¨Ö Home</button>
</div>

<!-- SOUND EFFECTS -->
<audio id="jumpSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="overSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const jumpSound = document.getElementById("jumpSound");
const overSound = document.getElementById("overSound");

let birdY, velocity, gravity, pipes, score, highScore, gameRunning;

highScore = localStorage.getItem("flappyHigh") || 0;

function startGame(){
  birdY = 200;
  velocity = 0;
  gravity = 0.5;
  pipes = [];
  score = 0;
  gameRunning = true;
  loop();
}

document.addEventListener("keydown", jump);
canvas.addEventListener("click", jump);

function jump(){
  if(!gameRunning) return;
  velocity = -8;
  jumpSound.currentTime = 0;
  jumpSound.play();
}

function loop(){
  if(!gameRunning) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  /* Bird */
  velocity += gravity;
  birdY += velocity;
  ctx.fillStyle = "yellow";
  ctx.beginPath();
  ctx.arc(60, birdY, 12, 0, Math.PI*2);
  ctx.fill();

  /* Pipes */
  if(pipes.length === 0 || pipes[pipes.length-1].x < 180){
    let gap = 130;
    let top = Math.random()*150 + 30;
    pipes.push({x:320, top:top, bottom:top+gap, scored:false});
  }

  ctx.fillStyle = "green";
  pipes.forEach(p => {
    p.x -= 2;
    ctx.fillRect(p.x,0,45,p.top);
    ctx.fillRect(p.x,p.bottom,45,420);

    if(p.x < 60 && !p.scored){
      score++;
      p.scored = true;
    }

    if(
      60 > p.x && 60 < p.x+45 &&
      (birdY < p.top || birdY > p.bottom)
    ){
      gameOver();
    }
  });

  pipes = pipes.filter(p => p.x > -50);

  /* Ground / Ceiling */
  if(birdY > 420 || birdY < 0){
    gameOver();
  }

  /* Score */
  ctx.fillStyle = "white";
  ctx.font = "18px Arial";
  ctx.fillText("Score: " + score, 10, 25);
  ctx.fillText("Best: " + highScore, 220, 25);

  requestAnimationFrame(loop);
}

function gameOver(){
  gameRunning = false;
  overSound.play();

  if(score > highScore){
    highScore = score;
    localStorage.setItem("flappyHigh", highScore);
  }

  ctx.fillStyle = "red";
  ctx.font = "30px Arial";
  ctx.fillText("Game Over", 70, 220);
}
</script>

</body>
</html>
